Loading dataset: mlabonne/guanaco-llama2-1k
Dataset loaded. Size: 1000
Preprocessing dataset...
Dataset preprocessed.
Loading base model: meta-llama/Llama-2-7b-chat-hf
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:06<00:06,  6.34s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:08<00:00,  3.85s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:08<00:00,  4.22s/it]
trainable params: 4,194,304 || all params: 6,742,609,920 || trainable%: 0.0622
Creating EntangledModel wrapper (Full Forward)...
EntangledModel wrapper created.
Setting up Training Arguments...
Initializing Standard Trainer for setup...
/workspace/sorya/phase2_training/train_entangled.py:410: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
Trainer initialized for setup.
Getting DataLoader...
DataLoader obtained.
Creating optimizer and scheduler...
Optimizer and scheduler created. Num training steps for scheduler: 1000
Starting MANUAL training loop...
Accelerator prepared.
--- Starting Epoch 1/1 ---
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 1] Loss: 6.6992 (LM: 5.8527, KL: 8.4645)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 2] Loss: 8.5257 (LM: 6.7643, KL: 17.6145)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 3] Loss: 9.5795 (LM: 6.5654, KL: 30.1407)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 4] Loss: 9.7723 (LM: 5.9255, KL: 38.4671)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 5] Loss: 3.5183 (LM: 1.6154, KL: 19.0293)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 6] Loss: 3.0205 (LM: 2.0396, KL: 9.8090)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 7] Loss: 2.7953 (LM: 1.4609, KL: 13.3444)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 8] Loss: 2.0767 (LM: 1.1953, KL: 8.8140)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 9] Loss: 1.8954 (LM: 1.3043, KL: 5.9113)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 10] Loss: 1.8136 (LM: 1.3019, KL: 5.1175)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 11] Loss: 1.5847 (LM: 0.9869, KL: 5.9782)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 12] Loss: 2.0261 (LM: 1.4325, KL: 5.9364)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 13] Loss: 1.3156 (LM: 0.9608, KL: 3.5478)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 14] Loss: 1.5821 (LM: 1.0142, KL: 5.6791)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 15] Loss: 0.9668 (LM: 0.6759, KL: 2.9086)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 16] Loss: 2.0275 (LM: 1.7196, KL: 3.0787)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 17] Loss: 1.7061 (LM: 1.3182, KL: 3.8795)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 18] Loss: 1.4438 (LM: 1.1665, KL: 2.7729)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 19] Loss: 2.4864 (LM: 2.0853, KL: 4.0110)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 20] Loss: 1.0050 (LM: 0.8198, KL: 1.8525)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 21] Loss: 1.2283 (LM: 1.1478, KL: 0.8054)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 22] Loss: 1.3520 (LM: 1.3049, KL: 0.4708)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 23] Loss: 1.3671 (LM: 1.1367, KL: 2.3032)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 24] Loss: 1.6091 (LM: 1.5466, KL: 0.6251)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 25] Loss: 1.8903 (LM: 1.8331, KL: 0.5726)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 26] Loss: 1.9138 (LM: 1.4583, KL: 4.5553)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 27] Loss: 0.7565 (LM: 0.7345, KL: 0.2203)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 28] Loss: 0.6660 (LM: 0.6505, KL: 0.1542)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 29] Loss: 1.2733 (LM: 1.1268, KL: 1.4652)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 30] Loss: 1.6590 (LM: 1.2882, KL: 3.7082)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 31] Loss: 0.9316 (LM: 0.9089, KL: 0.2267)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 32] Loss: 0.2636 (LM: 0.2455, KL: 0.1813)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 33] Loss: 0.9407 (LM: 0.7712, KL: 1.6957)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 34] Loss: 1.0370 (LM: 1.0249, KL: 0.1209)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 35] Loss: 1.3521 (LM: 1.2164, KL: 1.3567)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 36] Loss: 1.4790 (LM: 1.2812, KL: 1.9771)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 37] Loss: 1.2225 (LM: 0.9058, KL: 3.1670)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 38] Loss: 1.1418 (LM: 1.1341, KL: 0.0766)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 39] Loss: 1.2362 (LM: 1.0854, KL: 1.5075)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 40] Loss: 0.8813 (LM: 0.7473, KL: 1.3400)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 41] Loss: 1.1194 (LM: 0.8604, KL: 2.5896)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 42] Loss: 1.2795 (LM: 1.1199, KL: 1.5956)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 43] Loss: 0.8573 (LM: 0.8544, KL: 0.0288)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 44] Loss: 2.0052 (LM: 1.7254, KL: 2.7977)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 45] Loss: 1.1640 (LM: 1.0760, KL: 0.8798)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 46] Loss: 0.6702 (LM: 0.6693, KL: 0.0092)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 47] Loss: 0.8201 (LM: 0.8186, KL: 0.0151)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 48] Loss: 0.5850 (LM: 0.5846, KL: 0.0046)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 49] Loss: 0.7153 (LM: 0.7146, KL: 0.0068)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 50] Loss: 2.7027 (LM: 1.9996, KL: 7.0311)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 51] Loss: 0.8491 (LM: 0.8481, KL: 0.0106)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 52] Loss: 1.1712 (LM: 0.9229, KL: 2.4830)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 53] Loss: 1.3399 (LM: 1.0815, KL: 2.5844)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 54] Loss: 0.8498 (LM: 0.8487, KL: 0.0110)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 55] Loss: 1.0742 (LM: 1.0733, KL: 0.0092)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 56] Loss: 1.0529 (LM: 0.7921, KL: 2.6077)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 57] Loss: 0.7619 (LM: 0.6818, KL: 0.8002)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 58] Loss: 0.7996 (LM: 0.7716, KL: 0.2802)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 59] Loss: 0.5896 (LM: 0.5886, KL: 0.0105)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 60] Loss: 0.6551 (LM: 0.6545, KL: 0.0055)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 61] Loss: 0.5209 (LM: 0.5205, KL: 0.0038)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 62] Loss: 1.1278 (LM: 1.1278, KL: -0.0003)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 63] Loss: 0.8501 (LM: 0.8490, KL: 0.0102)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 64] Loss: 1.1183 (LM: 1.1177, KL: 0.0064)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 65] Loss: 0.7550 (LM: 0.6791, KL: 0.7580)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 66] Loss: 0.7258 (LM: 0.7249, KL: 0.0095)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 67] Loss: 1.2075 (LM: 0.8334, KL: 3.7412)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 68] Loss: 1.6316 (LM: 1.3210, KL: 3.1064)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 69] Loss: 2.3646 (LM: 1.9529, KL: 4.1169)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 70] Loss: 0.7181 (LM: 0.7182, KL: -0.0004)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 71] Loss: 0.7453 (LM: 0.7449, KL: 0.0047)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 72] Loss: 0.6934 (LM: 0.6934, KL: 0.0001)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 73] Loss: 1.0270 (LM: 1.0262, KL: 0.0084)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 74] Loss: 1.1355 (LM: 0.9054, KL: 2.3005)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 75] Loss: 1.2822 (LM: 1.1875, KL: 0.9473)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 76] Loss: 0.2516 (LM: 0.2511, KL: 0.0045)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 77] Loss: 0.7821 (LM: 0.7287, KL: 0.5337)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 78] Loss: 0.8464 (LM: 0.7172, KL: 1.2923)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 79] Loss: 0.8156 (LM: 0.8147, KL: 0.0096)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 80] Loss: 0.6981 (LM: 0.6968, KL: 0.0128)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 81] Loss: 0.7900 (LM: 0.7900, KL: 0.0001)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 82] Loss: 0.6432 (LM: 0.6424, KL: 0.0076)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 83] Loss: 0.4734 (LM: 0.4729, KL: 0.0052)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 84] Loss: 0.5535 (LM: 0.5535, KL: 0.0007)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 85] Loss: 0.9303 (LM: 0.8852, KL: 0.4515)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 86] Loss: 1.0021 (LM: 0.7132, KL: 2.8895)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 87] Loss: 1.1851 (LM: 1.1506, KL: 0.3459)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 88] Loss: 1.2708 (LM: 0.9618, KL: 3.0904)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 89] Loss: 0.5235 (LM: 0.4515, KL: 0.7202)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 90] Loss: 1.2236 (LM: 0.9455, KL: 2.7811)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 91] Loss: 0.6499 (LM: 0.6490, KL: 0.0093)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 92] Loss: 0.5446 (LM: 0.5437, KL: 0.0095)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 93] Loss: 1.0015 (LM: 1.0005, KL: 0.0097)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 94] Loss: 0.8669 (LM: 0.7762, KL: 0.9067)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 95] Loss: 0.8538 (LM: 0.8530, KL: 0.0081)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 96] Loss: 1.2673 (LM: 1.2664, KL: 0.0083)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 97] Loss: 0.8249 (LM: 0.8241, KL: 0.0087)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 98] Loss: 0.6927 (LM: 0.6920, KL: 0.0072)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 99] Loss: 0.2359 (LM: 0.2357, KL: 0.0021)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 100] Loss: 0.7792 (LM: 0.7223, KL: 0.5688)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 101] Loss: 0.3768 (LM: 0.3759, KL: 0.0084)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 102] Loss: 0.7523 (LM: 0.7518, KL: 0.0050)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 103] Loss: 0.8156 (LM: 0.7547, KL: 0.6082)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 104] Loss: 1.2697 (LM: 1.2686, KL: 0.0111)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 105] Loss: 0.4489 (LM: 0.4485, KL: 0.0041)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 106] Loss: 0.7490 (LM: 0.5894, KL: 1.5957)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 107] Loss: 0.4449 (LM: 0.4447, KL: 0.0013)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 108] Loss: 0.4429 (LM: 0.4435, KL: -0.0058)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 109] Loss: 0.5877 (LM: 0.5880, KL: -0.0034)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 110] Loss: 0.8311 (LM: 0.8310, KL: 0.0011)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 111] Loss: 0.9126 (LM: 0.8502, KL: 0.6248)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 112] Loss: 0.8259 (LM: 0.8257, KL: 0.0022)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 113] Loss: 1.0908 (LM: 1.0310, KL: 0.5980)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 114] Loss: 0.6768 (LM: 0.6763, KL: 0.0050)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 115] Loss: 1.1038 (LM: 1.0727, KL: 0.3111)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 116] Loss: 0.6452 (LM: 0.6442, KL: 0.0102)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 117] Loss: 1.0897 (LM: 0.9009, KL: 1.8885)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 118] Loss: 1.0353 (LM: 1.0131, KL: 0.2215)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 119] Loss: 1.2956 (LM: 1.2473, KL: 0.4831)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 120] Loss: 0.8948 (LM: 0.8730, KL: 0.2180)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 121] Loss: 0.8783 (LM: 0.8774, KL: 0.0090)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 122] Loss: 1.0683 (LM: 0.9913, KL: 0.7694)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 123] Loss: 0.8241 (LM: 0.8109, KL: 0.1317)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 124] Loss: 0.6557 (LM: 0.6543, KL: 0.0143)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 125] Loss: 0.6443 (LM: 0.6275, KL: 0.1680)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 126] Loss: 0.7092 (LM: 0.7081, KL: 0.0117)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 127] Loss: 1.0598 (LM: 1.0021, KL: 0.5770)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 128] Loss: 0.7605 (LM: 0.7587, KL: 0.0179)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 129] Loss: 1.0163 (LM: 0.9959, KL: 0.2045)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 130] Loss: 0.4238 (LM: 0.4221, KL: 0.0162)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 131] Loss: 1.1774 (LM: 1.1758, KL: 0.0167)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 132] Loss: 1.1411 (LM: 1.1206, KL: 0.2054)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 133] Loss: 0.9009 (LM: 0.8464, KL: 0.5444)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 134] Loss: 1.3595 (LM: 1.2904, KL: 0.6913)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 135] Loss: 0.5774 (LM: 0.5761, KL: 0.0129)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 136] Loss: 1.0660 (LM: 1.0642, KL: 0.0173)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 137] Loss: 0.4899 (LM: 0.4888, KL: 0.0107)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 138] Loss: 0.8269 (LM: 0.8245, KL: 0.0242)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 139] Loss: 1.1127 (LM: 1.1068, KL: 0.0597)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 140] Loss: 0.4403 (LM: 0.4390, KL: 0.0124)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 141] Loss: 0.5909 (LM: 0.5822, KL: 0.0873)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 142] Loss: 0.6179 (LM: 0.6159, KL: 0.0199)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 143] Loss: 0.6686 (LM: 0.6415, KL: 0.2716)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 144] Loss: 0.6304 (LM: 0.6293, KL: 0.0111)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 145] Loss: 0.8095 (LM: 0.8078, KL: 0.0164)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 146] Loss: 0.4161 (LM: 0.4149, KL: 0.0125)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 147] Loss: 0.6429 (LM: 0.6412, KL: 0.0166)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 148] Loss: 0.7061 (LM: 0.6915, KL: 0.1465)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 149] Loss: 1.0297 (LM: 1.0282, KL: 0.0149)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 150] Loss: 1.0328 (LM: 1.0313, KL: 0.0149)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 151] Loss: 0.7347 (LM: 0.7328, KL: 0.0190)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 152] Loss: 0.3865 (LM: 0.3845, KL: 0.0192)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 153] Loss: 0.6971 (LM: 0.6479, KL: 0.4918)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 154] Loss: 0.6463 (LM: 0.6443, KL: 0.0198)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 155] Loss: 1.1719 (LM: 1.1549, KL: 0.1695)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 156] Loss: 1.3873 (LM: 1.3751, KL: 0.1216)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 157] Loss: 0.6359 (LM: 0.6336, KL: 0.0228)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 158] Loss: 0.9267 (LM: 0.9245, KL: 0.0213)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 159] Loss: 0.8368 (LM: 0.8336, KL: 0.0321)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 160] Loss: 0.9686 (LM: 0.9582, KL: 0.1036)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 161] Loss: 1.6369 (LM: 1.6281, KL: 0.0885)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 162] Loss: 1.4644 (LM: 1.4166, KL: 0.4780)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 163] Loss: 1.1362 (LM: 1.0635, KL: 0.7271)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 164] Loss: 1.0539 (LM: 1.0516, KL: 0.0234)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 165] Loss: 1.3545 (LM: 1.3324, KL: 0.2207)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 166] Loss: 0.7021 (LM: 0.7000, KL: 0.0210)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 167] Loss: 1.0292 (LM: 1.0263, KL: 0.0288)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 168] Loss: 0.5370 (LM: 0.5344, KL: 0.0262)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 169] Loss: 1.0461 (LM: 1.0307, KL: 0.1542)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 170] Loss: 1.6454 (LM: 1.6118, KL: 0.3358)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 171] Loss: 0.5606 (LM: 0.5593, KL: 0.0137)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 172] Loss: 0.6770 (LM: 0.6746, KL: 0.0237)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 173] Loss: 2.3769 (LM: 2.3745, KL: 0.0241)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 174] Loss: 1.4195 (LM: 1.4094, KL: 0.1015)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 175] Loss: 1.5351 (LM: 1.5296, KL: 0.0552)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 176] Loss: 0.3602 (LM: 0.3579, KL: 0.0232)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 177] Loss: 1.0472 (LM: 1.0298, KL: 0.1743)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 178] Loss: 0.6316 (LM: 0.6292, KL: 0.0238)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 179] Loss: 0.7557 (LM: 0.7545, KL: 0.0121)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 180] Loss: 0.7864 (LM: 0.7795, KL: 0.0690)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 181] Loss: 0.8893 (LM: 0.8856, KL: 0.0371)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 182] Loss: 0.6312 (LM: 0.6291, KL: 0.0208)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 183] Loss: 1.9878 (LM: 1.9862, KL: 0.0157)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 184] Loss: 1.2362 (LM: 1.1890, KL: 0.4723)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 185] Loss: 1.7041 (LM: 1.6598, KL: 0.4427)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 186] Loss: 1.3217 (LM: 1.2988, KL: 0.2284)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 187] Loss: 0.7902 (LM: 0.7893, KL: 0.0088)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 188] Loss: 0.5134 (LM: 0.5127, KL: 0.0072)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 189] Loss: 0.7091 (LM: 0.6991, KL: 0.1002)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 190] Loss: 0.5959 (LM: 0.5951, KL: 0.0078)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 191] Loss: 0.8269 (LM: 0.8265, KL: 0.0042)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 192] Loss: 0.6217 (LM: 0.6212, KL: 0.0045)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 193] Loss: 0.6818 (LM: 0.6815, KL: 0.0030)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 194] Loss: 0.9025 (LM: 0.9019, KL: 0.0065)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 195] Loss: 0.4468 (LM: 0.4464, KL: 0.0036)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 196] Loss: 0.5596 (LM: 0.5592, KL: 0.0040)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 197] Loss: 0.6198 (LM: 0.6194, KL: 0.0043)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 198] Loss: 0.6390 (LM: 0.6385, KL: 0.0047)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 199] Loss: 0.8558 (LM: 0.8552, KL: 0.0069)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 200] Loss: 1.0460 (LM: 1.0457, KL: 0.0035)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 201] Loss: 0.4779 (LM: 0.4775, KL: 0.0039)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 202] Loss: 0.8646 (LM: 0.8644, KL: 0.0023)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 203] Loss: 0.5915 (LM: 0.5908, KL: 0.0068)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 204] Loss: 1.7066 (LM: 1.7024, KL: 0.0419)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 205] Loss: 0.6730 (LM: 0.6716, KL: 0.0143)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 206] Loss: 0.8263 (LM: 0.8250, KL: 0.0135)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 207] Loss: 1.3990 (LM: 1.3976, KL: 0.0139)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 208] Loss: 0.9308 (LM: 0.9275, KL: 0.0333)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 209] Loss: 0.9690 (LM: 0.9678, KL: 0.0122)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 210] Loss: 0.4481 (LM: 0.4464, KL: 0.0166)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 211] Loss: 0.7816 (LM: 0.7799, KL: 0.0169)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 212] Loss: 1.6636 (LM: 1.6558, KL: 0.0773)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 213] Loss: 0.7144 (LM: 0.7126, KL: 0.0177)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 214] Loss: 0.8360 (LM: 0.8339, KL: 0.0201)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 215] Loss: 1.0964 (LM: 1.0943, KL: 0.0205)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 216] Loss: 1.1020 (LM: 1.0892, KL: 0.1288)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 217] Loss: 1.2195 (LM: 1.2093, KL: 0.1017)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 218] Loss: 0.7386 (LM: 0.7310, KL: 0.0760)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 219] Loss: 0.5649 (LM: 0.5628, KL: 0.0214)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 220] Loss: 1.1072 (LM: 1.1051, KL: 0.0215)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 221] Loss: 0.6713 (LM: 0.6689, KL: 0.0237)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 222] Loss: 0.8432 (LM: 0.8408, KL: 0.0236)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 223] Loss: 0.5800 (LM: 0.5776, KL: 0.0237)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 224] Loss: 0.6040 (LM: 0.5851, KL: 0.1891)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 225] Loss: 0.8629 (LM: 0.8607, KL: 0.0220)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 226] Loss: 0.9137 (LM: 0.9115, KL: 0.0222)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 227] Loss: 0.7550 (LM: 0.7527, KL: 0.0225)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 228] Loss: 0.7995 (LM: 0.7974, KL: 0.0215)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 229] Loss: 0.0929 (LM: 0.0908, KL: 0.0210)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 230] Loss: 0.6426 (LM: 0.6405, KL: 0.0212)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 231] Loss: 1.1651 (LM: 1.1597, KL: 0.0544)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 232] Loss: 1.1548 (LM: 1.1413, KL: 0.1345)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 233] Loss: 1.2439 (LM: 1.1707, KL: 0.7320)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 234] Loss: 0.9098 (LM: 0.9078, KL: 0.0196)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 235] Loss: 1.2672 (LM: 1.2638, KL: 0.0338)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 236] Loss: 0.9775 (LM: 0.9746, KL: 0.0282)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 237] Loss: 0.5437 (LM: 0.5418, KL: 0.0196)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 238] Loss: 0.7238 (LM: 0.7220, KL: 0.0178)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 239] Loss: 1.0939 (LM: 1.0897, KL: 0.0415)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 240] Loss: 0.6542 (LM: 0.6522, KL: 0.0200)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 241] Loss: 0.7374 (LM: 0.7339, KL: 0.0350)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 242] Loss: 0.9958 (LM: 0.9917, KL: 0.0411)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 243] Loss: 1.2458 (LM: 1.2438, KL: 0.0200)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 244] Loss: 0.8118 (LM: 0.8096, KL: 0.0214)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 245] Loss: 0.8222 (LM: 0.8206, KL: 0.0165)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 246] Loss: 0.6307 (LM: 0.6291, KL: 0.0165)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 247] Loss: 0.6633 (LM: 0.6614, KL: 0.0189)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 248] Loss: 0.8060 (LM: 0.8042, KL: 0.0180)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 249] Loss: 1.3086 (LM: 1.2476, KL: 0.6095)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 250] Loss: 1.0633 (LM: 1.0616, KL: 0.0169)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 251] Loss: 1.0010 (LM: 0.9993, KL: 0.0170)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 252] Loss: 0.5731 (LM: 0.5717, KL: 0.0147)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 253] Loss: 0.4396 (LM: 0.4379, KL: 0.0172)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 254] Loss: 0.9475 (LM: 0.9468, KL: 0.0079)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 255] Loss: 1.2990 (LM: 1.2914, KL: 0.0765)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 256] Loss: 1.5336 (LM: 1.5233, KL: 0.1033)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 257] Loss: 0.8465 (LM: 0.8449, KL: 0.0158)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 258] Loss: 0.6500 (LM: 0.6484, KL: 0.0160)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 259] Loss: 0.8958 (LM: 0.8945, KL: 0.0126)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 260] Loss: 0.7971 (LM: 0.7955, KL: 0.0163)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 261] Loss: 1.4644 (LM: 1.4623, KL: 0.0206)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 262] Loss: 0.8615 (LM: 0.8599, KL: 0.0167)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 263] Loss: 0.9139 (LM: 0.9087, KL: 0.0516)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 264] Loss: 1.0086 (LM: 0.9988, KL: 0.0972)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 265] Loss: 0.7977 (LM: 0.7913, KL: 0.0632)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 266] Loss: 0.7400 (LM: 0.7374, KL: 0.0257)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 267] Loss: 1.5395 (LM: 1.5378, KL: 0.0167)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 268] Loss: 0.8554 (LM: 0.8545, KL: 0.0097)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 269] Loss: 0.7973 (LM: 0.7958, KL: 0.0150)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 270] Loss: 0.7388 (LM: 0.7381, KL: 0.0067)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 271] Loss: 0.9152 (LM: 0.9136, KL: 0.0156)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 272] Loss: 0.8606 (LM: 0.8578, KL: 0.0283)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 273] Loss: 0.7785 (LM: 0.7769, KL: 0.0163)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 274] Loss: 1.1263 (LM: 1.1239, KL: 0.0247)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 275] Loss: 0.5095 (LM: 0.5078, KL: 0.0170)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 276] Loss: 1.2180 (LM: 1.2163, KL: 0.0173)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 277] Loss: 0.9496 (LM: 0.9480, KL: 0.0161)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 278] Loss: 0.5079 (LM: 0.5061, KL: 0.0177)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 279] Loss: 0.9948 (LM: 0.9925, KL: 0.0224)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 280] Loss: 0.7778 (LM: 0.7760, KL: 0.0180)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 281] Loss: 1.0642 (LM: 1.0624, KL: 0.0179)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 282] Loss: 1.1241 (LM: 1.1175, KL: 0.0653)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 283] Loss: 1.1710 (LM: 1.1607, KL: 0.1031)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 284] Loss: 0.9745 (LM: 0.9724, KL: 0.0210)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 285] Loss: 0.9039 (LM: 0.9021, KL: 0.0187)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 286] Loss: 1.7608 (LM: 1.7587, KL: 0.0210)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 287] Loss: 0.3895 (LM: 0.3876, KL: 0.0191)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 288] Loss: 1.1131 (LM: 1.1075, KL: 0.0554)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 289] Loss: 0.7017 (LM: 0.6997, KL: 0.0194)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 290] Loss: 0.7273 (LM: 0.7253, KL: 0.0195)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 291] Loss: 0.6756 (LM: 0.6736, KL: 0.0195)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 292] Loss: 0.9082 (LM: 0.9046, KL: 0.0360)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 293] Loss: 1.5973 (LM: 1.5831, KL: 0.1423)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 294] Loss: 0.9387 (LM: 0.9367, KL: 0.0200)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 295] Loss: 0.7433 (LM: 0.7410, KL: 0.0232)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 296] Loss: 1.1746 (LM: 1.1546, KL: 0.2001)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 297] Loss: 1.2841 (LM: 1.2807, KL: 0.0340)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 298] Loss: 0.6184 (LM: 0.6164, KL: 0.0201)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 299] Loss: 0.6691 (LM: 0.6671, KL: 0.0201)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 300] Loss: 0.8608 (LM: 0.8588, KL: 0.0200)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 301] Loss: 0.8835 (LM: 0.8815, KL: 0.0200)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 302] Loss: 0.7694 (LM: 0.7660, KL: 0.0340)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 303] Loss: 0.9210 (LM: 0.9190, KL: 0.0200)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 304] Loss: 0.9299 (LM: 0.9279, KL: 0.0200)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 305] Loss: 0.6745 (LM: 0.6725, KL: 0.0201)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 306] Loss: 0.7207 (LM: 0.7187, KL: 0.0201)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 307] Loss: 0.8009 (LM: 0.7885, KL: 0.1240)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 308] Loss: 1.2721 (LM: 1.2701, KL: 0.0202)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 309] Loss: 0.7430 (LM: 0.7410, KL: 0.0203)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 310] Loss: 0.3876 (LM: 0.3856, KL: 0.0203)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 311] Loss: 0.5203 (LM: 0.5153, KL: 0.0496)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 312] Loss: 0.7350 (LM: 0.7330, KL: 0.0204)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 313] Loss: 1.0208 (LM: 1.0194, KL: 0.0140)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 314] Loss: 0.9406 (LM: 0.9336, KL: 0.0700)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 315] Loss: 1.0340 (LM: 1.0312, KL: 0.0284)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 316] Loss: 1.2374 (LM: 1.2349, KL: 0.0259)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 317] Loss: 0.2664 (LM: 0.2644, KL: 0.0202)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 318] Loss: 1.1658 (LM: 1.1638, KL: 0.0200)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 319] Loss: 1.4758 (LM: 1.4739, KL: 0.0198)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 320] Loss: 1.0211 (LM: 1.0192, KL: 0.0198)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 321] Loss: 1.0960 (LM: 1.0940, KL: 0.0197)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 322] Loss: 0.8089 (LM: 0.8078, KL: 0.0111)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 323] Loss: 0.5133 (LM: 0.5114, KL: 0.0196)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 324] Loss: 0.3477 (LM: 0.3458, KL: 0.0196)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 325] Loss: 1.0080 (LM: 0.9946, KL: 0.1340)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 326] Loss: 1.4164 (LM: 1.4129, KL: 0.0351)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 327] Loss: 0.7253 (LM: 0.7236, KL: 0.0169)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 328] Loss: 0.5328 (LM: 0.5308, KL: 0.0197)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 329] Loss: 1.0329 (LM: 1.0309, KL: 0.0198)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 330] Loss: 0.7790 (LM: 0.7770, KL: 0.0198)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 331] Loss: 0.5572 (LM: 0.5556, KL: 0.0158)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 332] Loss: 0.9074 (LM: 0.9054, KL: 0.0200)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 333] Loss: 0.7491 (LM: 0.7471, KL: 0.0202)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 334] Loss: 0.5956 (LM: 0.5936, KL: 0.0204)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 335] Loss: 1.3121 (LM: 1.3101, KL: 0.0206)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 336] Loss: 0.8066 (LM: 0.8045, KL: 0.0207)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 337] Loss: 0.8229 (LM: 0.8193, KL: 0.0354)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 338] Loss: 0.7141 (LM: 0.7120, KL: 0.0210)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 339] Loss: 1.0586 (LM: 1.0565, KL: 0.0212)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 340] Loss: 0.7113 (LM: 0.7084, KL: 0.0292)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 341] Loss: 0.5501 (LM: 0.5479, KL: 0.0217)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 342] Loss: 1.7104 (LM: 1.7082, KL: 0.0217)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 343] Loss: 1.1728 (LM: 1.1705, KL: 0.0224)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 344] Loss: 1.3843 (LM: 1.3818, KL: 0.0248)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 345] Loss: 0.7949 (LM: 0.7925, KL: 0.0237)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 346] Loss: 0.6887 (LM: 0.6865, KL: 0.0219)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 347] Loss: 0.7960 (LM: 0.7946, KL: 0.0137)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 348] Loss: 1.0787 (LM: 1.0763, KL: 0.0242)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 349] Loss: 0.8850 (LM: 0.8826, KL: 0.0244)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 350] Loss: 0.8618 (LM: 0.8597, KL: 0.0207)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 351] Loss: 0.8248 (LM: 0.8223, KL: 0.0248)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 352] Loss: 0.8816 (LM: 0.8791, KL: 0.0250)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 353] Loss: 1.0522 (LM: 1.0472, KL: 0.0497)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 354] Loss: 0.8515 (LM: 0.8490, KL: 0.0253)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 355] Loss: 0.4455 (LM: 0.4429, KL: 0.0255)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 356] Loss: 0.2949 (LM: 0.2923, KL: 0.0257)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 357] Loss: 1.1253 (LM: 1.1237, KL: 0.0166)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 358] Loss: 0.7036 (LM: 0.6928, KL: 0.1081)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 359] Loss: 0.1993 (LM: 0.1967, KL: 0.0259)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 360] Loss: 0.7094 (LM: 0.7068, KL: 0.0260)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 361] Loss: 0.5483 (LM: 0.5457, KL: 0.0260)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 362] Loss: 0.6062 (LM: 0.6036, KL: 0.0260)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 363] Loss: 0.5090 (LM: 0.5064, KL: 0.0261)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 364] Loss: 0.3773 (LM: 0.3747, KL: 0.0261)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 365] Loss: 0.9595 (LM: 0.9569, KL: 0.0261)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 366] Loss: 0.3787 (LM: 0.3761, KL: 0.0261)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 367] Loss: 0.7716 (LM: 0.7690, KL: 0.0262)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 368] Loss: 0.7190 (LM: 0.7164, KL: 0.0262)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 369] Loss: 1.1798 (LM: 1.1772, KL: 0.0262)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 370] Loss: 1.0646 (LM: 1.0173, KL: 0.4738)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 371] Loss: 1.5273 (LM: 1.5247, KL: 0.0260)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 372] Loss: 0.3992 (LM: 0.3966, KL: 0.0259)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 373] Loss: 1.0179 (LM: 1.0144, KL: 0.0347)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 374] Loss: 0.5043 (LM: 0.5018, KL: 0.0255)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 375] Loss: 1.1221 (LM: 1.1196, KL: 0.0254)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 376] Loss: 0.6490 (LM: 0.6465, KL: 0.0253)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 377] Loss: 1.4576 (LM: 1.4454, KL: 0.1216)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 378] Loss: 0.6692 (LM: 0.6620, KL: 0.0721)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 379] Loss: 1.1841 (LM: 1.1825, KL: 0.0163)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 380] Loss: 0.4745 (LM: 0.4720, KL: 0.0255)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 381] Loss: 0.9427 (LM: 0.9411, KL: 0.0162)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 382] Loss: 0.6089 (LM: 0.6068, KL: 0.0208)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 383] Loss: 1.0360 (LM: 1.0330, KL: 0.0298)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 384] Loss: 0.7141 (LM: 0.7125, KL: 0.0160)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 385] Loss: 0.6650 (LM: 0.6599, KL: 0.0508)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 386] Loss: 1.8192 (LM: 1.8166, KL: 0.0261)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 387] Loss: 0.7556 (LM: 0.7544, KL: 0.0113)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 388] Loss: 0.5282 (LM: 0.5256, KL: 0.0264)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 389] Loss: 0.5702 (LM: 0.5676, KL: 0.0265)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 390] Loss: 1.4162 (LM: 1.4137, KL: 0.0247)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 391] Loss: 1.5759 (LM: 1.5692, KL: 0.0664)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 392] Loss: 0.8224 (LM: 0.8197, KL: 0.0270)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 393] Loss: 0.6830 (LM: 0.6803, KL: 0.0272)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 394] Loss: 0.9333 (LM: 0.9256, KL: 0.0762)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 395] Loss: 0.5659 (LM: 0.5632, KL: 0.0273)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 396] Loss: 0.4942 (LM: 0.4915, KL: 0.0272)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 397] Loss: 0.7927 (LM: 0.7914, KL: 0.0124)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 398] Loss: 0.5467 (LM: 0.5435, KL: 0.0316)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 399] Loss: 0.6830 (LM: 0.6803, KL: 0.0269)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 400] Loss: 0.8089 (LM: 0.8062, KL: 0.0269)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 401] Loss: 0.6315 (LM: 0.6288, KL: 0.0268)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 402] Loss: 0.6422 (LM: 0.6395, KL: 0.0268)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 403] Loss: 0.5124 (LM: 0.5097, KL: 0.0269)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 404] Loss: 0.5421 (LM: 0.5394, KL: 0.0269)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 405] Loss: 0.5655 (LM: 0.5628, KL: 0.0269)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 406] Loss: 1.0443 (LM: 1.0420, KL: 0.0225)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 407] Loss: 0.7793 (LM: 0.7766, KL: 0.0271)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 408] Loss: 0.5935 (LM: 0.5908, KL: 0.0271)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 409] Loss: 0.5045 (LM: 0.5018, KL: 0.0272)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 410] Loss: 0.6641 (LM: 0.6610, KL: 0.0315)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 411] Loss: 1.2485 (LM: 1.2461, KL: 0.0241)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 412] Loss: 0.7353 (LM: 0.7325, KL: 0.0277)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 413] Loss: 1.4934 (LM: 1.4916, KL: 0.0187)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 414] Loss: 0.7674 (LM: 0.7646, KL: 0.0282)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 415] Loss: 0.2837 (LM: 0.2808, KL: 0.0284)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 416] Loss: 0.9978 (LM: 0.9911, KL: 0.0668)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 417] Loss: 1.2362 (LM: 1.2341, KL: 0.0210)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 418] Loss: 1.1141 (LM: 1.1113, KL: 0.0287)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 419] Loss: 0.5575 (LM: 0.5546, KL: 0.0287)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 420] Loss: 0.8736 (LM: 0.8707, KL: 0.0288)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 421] Loss: 0.6156 (LM: 0.6127, KL: 0.0288)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 422] Loss: 0.6932 (LM: 0.6903, KL: 0.0288)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 423] Loss: 0.9527 (LM: 0.9502, KL: 0.0252)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 424] Loss: 0.8494 (LM: 0.8465, KL: 0.0290)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 425] Loss: 0.3394 (LM: 0.3365, KL: 0.0292)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 426] Loss: 0.5814 (LM: 0.5785, KL: 0.0292)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 427] Loss: 0.9111 (LM: 0.9070, KL: 0.0419)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 428] Loss: 1.1025 (LM: 1.0996, KL: 0.0293)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 429] Loss: 0.2861 (LM: 0.2832, KL: 0.0292)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 430] Loss: 0.7353 (LM: 0.7324, KL: 0.0292)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 431] Loss: 0.7028 (LM: 0.7012, KL: 0.0154)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 432] Loss: 0.5490 (LM: 0.5461, KL: 0.0291)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 433] Loss: 1.0555 (LM: 1.0526, KL: 0.0290)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 434] Loss: 1.5790 (LM: 1.5766, KL: 0.0237)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 435] Loss: 0.9061 (LM: 0.8892, KL: 0.1685)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 436] Loss: 1.0559 (LM: 1.0531, KL: 0.0288)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 437] Loss: 0.7892 (LM: 0.7876, KL: 0.0162)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 438] Loss: 0.9374 (LM: 0.9345, KL: 0.0286)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 439] Loss: 0.5880 (LM: 0.5852, KL: 0.0286)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 440] Loss: 0.4912 (LM: 0.4884, KL: 0.0285)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 441] Loss: 0.9976 (LM: 0.9947, KL: 0.0285)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 442] Loss: 1.0503 (LM: 1.0474, KL: 0.0284)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 443] Loss: 0.6497 (LM: 0.6469, KL: 0.0284)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 444] Loss: 0.5748 (LM: 0.5719, KL: 0.0284)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 445] Loss: 0.7711 (LM: 0.7683, KL: 0.0283)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 446] Loss: 0.8573 (LM: 0.8544, KL: 0.0283)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 447] Loss: 0.5886 (LM: 0.5858, KL: 0.0283)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 448] Loss: 0.6932 (LM: 0.6903, KL: 0.0283)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 449] Loss: 1.3259 (LM: 1.3231, KL: 0.0283)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 450] Loss: 0.3696 (LM: 0.3668, KL: 0.0283)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 451] Loss: 1.3132 (LM: 1.3112, KL: 0.0204)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 452] Loss: 0.7277 (LM: 0.7260, KL: 0.0179)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 453] Loss: 0.7812 (LM: 0.7783, KL: 0.0281)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 454] Loss: 0.8658 (LM: 0.8638, KL: 0.0190)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 455] Loss: 1.1581 (LM: 1.1554, KL: 0.0263)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 456] Loss: 1.2658 (LM: 1.2630, KL: 0.0281)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 457] Loss: 0.9824 (LM: 0.9796, KL: 0.0281)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 458] Loss: 0.9127 (LM: 0.9112, KL: 0.0145)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 459] Loss: 0.9990 (LM: 0.9981, KL: 0.0091)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 460] Loss: 0.3703 (LM: 0.3675, KL: 0.0281)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 461] Loss: 1.3277 (LM: 1.3249, KL: 0.0282)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 462] Loss: 0.8240 (LM: 0.8198, KL: 0.0412)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 463] Loss: 0.6578 (LM: 0.6550, KL: 0.0282)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 464] Loss: 0.4164 (LM: 0.4136, KL: 0.0282)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 465] Loss: 0.3002 (LM: 0.2974, KL: 0.0282)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 466] Loss: 0.7121 (LM: 0.6928, KL: 0.1932)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 467] Loss: 1.1790 (LM: 1.1743, KL: 0.0475)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 468] Loss: 0.6691 (LM: 0.6675, KL: 0.0161)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 469] Loss: 0.6984 (LM: 0.6955, KL: 0.0291)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 470] Loss: 0.5678 (LM: 0.5649, KL: 0.0293)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 471] Loss: 0.7101 (LM: 0.7069, KL: 0.0320)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 472] Loss: 1.0228 (LM: 1.0198, KL: 0.0298)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 473] Loss: 0.9197 (LM: 0.9176, KL: 0.0212)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 474] Loss: 1.3987 (LM: 1.3963, KL: 0.0239)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 475] Loss: 0.8713 (LM: 0.8683, KL: 0.0304)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 476] Loss: 0.7911 (LM: 0.7881, KL: 0.0306)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 477] Loss: 0.5044 (LM: 0.5018, KL: 0.0256)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 478] Loss: 0.8817 (LM: 0.8785, KL: 0.0324)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 479] Loss: 0.6939 (LM: 0.6908, KL: 0.0310)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 480] Loss: 1.8553 (LM: 1.8534, KL: 0.0193)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 481] Loss: 1.0720 (LM: 1.0653, KL: 0.0670)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 482] Loss: 1.0778 (LM: 1.0747, KL: 0.0314)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 483] Loss: 0.4767 (LM: 0.4736, KL: 0.0317)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 484] Loss: 0.6499 (LM: 0.6467, KL: 0.0319)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 485] Loss: 1.2207 (LM: 1.2175, KL: 0.0321)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 486] Loss: 0.9808 (LM: 0.9776, KL: 0.0323)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 487] Loss: 0.6481 (LM: 0.6449, KL: 0.0325)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 488] Loss: 1.1899 (LM: 1.1866, KL: 0.0326)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 489] Loss: 1.8148 (LM: 1.8135, KL: 0.0126)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 490] Loss: 0.8246 (LM: 0.8229, KL: 0.0177)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 491] Loss: 0.4412 (LM: 0.4379, KL: 0.0329)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 492] Loss: 0.6721 (LM: 0.6704, KL: 0.0163)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 493] Loss: 0.9676 (LM: 0.9410, KL: 0.2663)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 494] Loss: 0.8853 (LM: 0.8733, KL: 0.1202)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 495] Loss: 0.6222 (LM: 0.6188, KL: 0.0332)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 496] Loss: 0.8260 (LM: 0.8242, KL: 0.0181)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 497] Loss: 1.1018 (LM: 1.0964, KL: 0.0537)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 498] Loss: 0.7709 (LM: 0.7675, KL: 0.0334)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 499] Loss: 0.4976 (LM: 0.4942, KL: 0.0334)
>>> [DEBUG KL Calc] logvar.shape=torch.Size([2, 64])
>>> [DEBUG Shape Check] Before commitment: base_outputs.logits shape = torch.Size([2, 512, 32000])
>>> [Step] Calculating loss...
>>> [DEBUG Loss Calc] Entering loss calc: final_logits shape=torch.Size([2, 512, 32000])
>>> [DEBUG Loss Calc] Before view: shift_logits shape=torch.Size([2, 511, 32000]), shift_labels shape=torch.Size([2, 511])
>>> [DEBUG Loss Calc] After view: shift_logits shape=torch.Size([1022, 32000]), shift_labels shape=torch.Size([1022])
>>> [DEBUG Loss Calc] Before .to(): type(shift_labels)=<class 'torch.Tensor'>, type(shift_logits)=<class 'torch.Tensor'>
>>> [DEBUG Loss Calc] shift_logits.device = cuda:0
>>> [DEBUG Loss Calc] shift_labels exists.
>>> [Global Step 500] Loss: 0.6501 (LM: 0.6468, KL: 0.0334)
--- Manual training loop finished ---
Saving final model components...
Model components saved.
Phase 2 Training Script (Manual Loop) Complete
